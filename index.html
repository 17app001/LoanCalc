<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>貸款試算0.1版</title>
    <style>
        form {
            text-align: left;
            background-color: antiquewhite;
            padding: 24px;
            border-radius: 12px;
            width: 500px;
            margin: 0 auto;
        }

        table {
            border-collapse: collapse;
            width: 60%;
            margin: 24px auto;
        }

        th,
        td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
        }

        @media (max-width: 767px) {
            table {
                width: 100%;
            }

            form {
                width: 300px;
            }
        }

        #container {
            width: 90%;
            margin: 0 auto;
            text-align: center;

        }
    </style>
</head>

<body>
    <div id="container">
        <h1>貸款利息計算機</h1>
        <form>
            <label for="loanAmount">貸款金額</label>
            <input type="number" name="loanAmount" id="loanAmount" value="100000">元<br>
            <label for="interestRate">貸款利率</label>
            <input type="number" name="interestRate" id="interestRate" value="10">年利率<br>
            <label for="loanTerm">還款週期</label>
            <select name="loanTerm" id="loanTerm">貸款試算
                <option value="3">3年</option>
                <option value="5">5年</option>
                <option value="7">7年</option>
                <option value="20">20年</option>
            </select><br>
            <label>還款方式</label>
            <input type="radio" name="replacement" id="PrincipalRepayment" checked>本金攤還
            <input type="radio" name="replacement" id="AmortizationInterest">本息攤還
            <br>
            <button type="button" onclick="calcTable()">計算</button>
        </form>

        <div id="result">

        </div>
        <table id="resultTable">
            <tr>
                <th>期別</th>
                <th>償還本金</th>
                <th>償還利息</th>
                <th>償還本利和</th>
                <th>貸款餘額</th>
            </tr>
        </table>

    </div>

    <script>
        const LoanAmountEl = document.querySelector("#loanAmount");
        const InterestRateEl = document.querySelector("#interestRate");
        const LoanTermEl = document.querySelector("#loanTerm");
        const resultEl = document.querySelector("#result");

        console.log(resultEl);
        //resultEl.innerHTML = "<h1>目前結果:</h1>";

        function calcTable() {
            // 清空表格內容
            while (resultTable.rows.length > 1) {
                resultTable.deleteRow(1);
            }

            // 獲取輸入框的值
            let loanAmount = parseFloat(LoanAmountEl.value);
            let interestRate = parseFloat(InterestRateEl.value);
            let loanTerm = parseFloat(LoanTermEl.value);

            let proid = loanTerm * 12;
            let monthRepayment = Math.round(loanAmount / proid);
            let totalInterest = 0;

            for (let i = 0; i < proid; i++) {
                let interest = Math.round(loanAmount * (interestRate / 100 / 12));
                totalInterest += interest;

                let row = resultTable.insertRow();
                let cell1 = row.insertCell();
                let cell2 = row.insertCell();
                let cell3 = row.insertCell();
                let cell4 = row.insertCell();
                let cell5 = row.insertCell();

                cell1.innerText = i + 1;
                cell2.innerText = monthRepayment;
                cell3.innerText = interest;
                cell4.innerText = monthRepayment + interest;
                cell5.innerText = loanAmount - monthRepayment;

                loanAmount -= monthRepayment;
            }

            resultEl.innerHTML = `<h2 style="color:blue">總利息支出為:${totalInterest}</h2>`;

        }


        function calc() {
            // 貸款金額
            let loanAmount = LoanAmountEl.value;
            // 年利率
            let interestRate = InterestRateEl.value;
            // 年限
            let loanTerm = LoanTermEl.value;

            console.log(loanAmount, interestRate, loanTerm);

            let proid = loanTerm * 12;
            let monthReplacement = parseInt(loanAmount / proid);

            let totalInterest = 0;
            for (let i = 0; i < proid; i++) {
                let interest = Math.round(loanAmount * (interestRate / 100 / 12));
                totalInterest += interest;
                let text;
                if (i == proid - 1) {
                    text = `期別:${i + 1} 償還本金:${monthReplacement + loanAmount - monthReplacement} 償還利息:${interest} 
                    償還本利和:${monthReplacement + loanAmount - monthReplacement + interest} 貸款餘額:${0}`
                    console.log(text);
                }
                else {
                    text = `期別:${i + 1} 償還本金:${monthReplacement} 償還利息:${interest} 
                    償還本利和:${monthReplacement + interest} 貸款餘額:${loanAmount - monthReplacement}`
                    console.log(text);

                }

                resultEl.innerHTML += `<li>${text}</li>`;

                loanAmount -= monthReplacement;
            }
            //print(f'總支出利息:{totalInterest}')
        }

    </script>
</body>

</html>